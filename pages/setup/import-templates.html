<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>FarmVista ‚Ä¢ Setup ‚Üí Import Templates</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <meta name="theme-color" content="#3B7E46"/>

  <!-- Standard includes (ABSOLUTE paths) -->
  <link rel="manifest" href="/Farm-vista/manifest.webmanifest"/>
  <link rel="apple-touch-icon" href="/Farm-vista/assets/icons/apple-touch-icon.png"/>
  <link rel="icon" href="/Farm-vista/assets/icons/icon-192.png"/>
  <script src="/Farm-vista/js/theme-boot.js"></script>

  <!-- ‚úÖ Permission UI controller -->
  <script src="/Farm-vista/js/perm-ui.js"></script>

  <link rel="stylesheet" href="/Farm-vista/assets/css/theme.css"/>
  <link rel="stylesheet" href="/Farm-vista/assets/css/app.css"/>

  <!-- Shell (registers <fv-shell>) -->
  <script>
    (function () {
      if (!customElements.get('fv-shell')) {
        const s = document.createElement('script');
        s.src = '/Farm-vista/js/fv-shell.js'; s.defer = true; document.head.appendChild(s);
      }
    })();
  </script>

  <style>
    .page { max-width:1100px; margin:0 auto; padding:clamp(14px,3vw,22px); }
    .page-title { margin:0 0 8px; }
    .page-sub { margin:0 0 18px; opacity:.9; }

    .tpl-list { display:grid; gap:clamp(12px,2.6vw,18px); }

    .tpl-card{
      background:#fff;
      border-radius:16px;
      border:1px solid rgba(0,0,0,.12);
      box-shadow:0 8px 20px rgba(0,0,0,.12);
      padding:14px;
    }
    .tpl-card h3{
      margin:0 0 10px;
      display:flex;
      align-items:center;
      gap:8px;
      font-size:16px;
    }

    .tpl-actions{ display:flex; flex-wrap:wrap; gap:10px; }
    a{ color:inherit; text-decoration:none; }
    .btn{
      display:inline-block;
      padding:10px 12px;
      border-radius:12px;
      border:1px solid currentColor;
      line-height:1.1;
      font-weight:600;
      background:transparent;
    }
    .btn:hover{ text-decoration:underline; }
    .cols{ font-size:12px; opacity:.75; margin-top:8px; }

    .tpl-card.is-coming-soon{
      opacity:0.98;
      position:relative;
    }
    .tpl-card.is-coming-soon .btn{
      opacity:0.4;
      pointer-events:none;
      cursor:default;
      text-decoration:none !important;
    }
    .coming-pill{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:4px 10px;
      border-radius:999px;
      border:1px solid rgba(0,0,0,.2);
      font-size:11px;
      font-weight:700;
      margin-top:8px;
      background:rgba(0,0,0,.03);
    }
    .coming-pill span{ opacity:0.8; }

    .modal{
      position:fixed;
      inset:0;
      display:none;
      place-items:center;
      background:rgba(0,0,0,.42);
      z-index:9999;
      transition:opacity .15s;
      opacity:0;
    }
    .modal[open]{ display:grid; opacity:1; }

    .dialog{
      width:min(640px,92vw);
      max-height:80vh;
      display:flex;
      flex-direction:column;
      background:var(--surface,#fff);
      color:var(--text,#111);
      border-radius:14px;
      border:1px solid var(--border,rgba(0,0,0,.12));
      box-shadow:0 16px 36px rgba(0,0,0,.28);
    }
    .dialog-head{
      padding:12px 14px;
      border-bottom:1px solid var(--border,rgba(0,0,0,.12));
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
    }
    .dialog-head h3{ margin:0; font-size:16px; }
    .dialog-body{
      padding:14px;
      display:grid;
      gap:10px;
      overflow:auto;
    }
    .dialog-footer{
      display:flex;
      justify-content:flex-end;
      padding:10px 14px;
      border-top:1px solid var(--border,rgba(0,0,0,.12));
      gap:10px;
    }
    .closex{
      border:1px solid var(--border,rgba(0,0,0,.12));
      background:var(--surface,#fff);
      border-radius:10px;
      padding:8px 12px;
      cursor:pointer;
      font-weight:700;
      color:var(--text,#111) !important;
    }
    .csv-preview{
      font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size:13px;
      background:rgba(0,0,0,.03);
      border-radius:10px;
      padding:10px 12px;
      overflow-x:auto;
      white-space:pre;
    }
    .csv-note{ font-size:12px; opacity:.8; }

    html.no-scroll, body.no-scroll{
      overflow:hidden;
      touch-action:none;
    }
  </style>
</head>
<body>
  <fv-shell app-title="Import Templates" data-page="setup-import-templates">
    <!-- Page visibility -->
    <div class="page container" data-perm="setup-import-templates:view">
      <h1 class="page-title">Import Templates</h1>
      <p class="page-sub">
        Download ready-to-use CSV/XLSX templates for bulk imports.
        Today only <strong>Fields</strong> is active ‚Äî the rest are marked <strong>Coming soon</strong> on purpose.
      </p>

      <section class="tpl-list" aria-label="Template details">

        <!-- ACTIVE: Fields -->
        <article class="tpl-card" id="tpl-fields">
          <h3>üó∫Ô∏è Fields</h3>
          <div class="tpl-actions" data-perm="setup-import-templates:view">
            <a class="btn" href="#" id="btnFieldsViewCsv">View CSV</a>
            <a class="btn" href="/Farm-vista/assets/templates/fields-template.csv" download>Download CSV</a>
            <a class="btn" href="/Farm-vista/assets/templates/fields-template.xlsx" download>Download XLSX</a>
          </div>
          <div class="cols">
            Columns: farmCode, name, state, county, tillableAcres, helAcres, crpAcres, rtkTowerCode, status
          </div>
        </article>

        <!-- COMING SOON: Seed -->
        <article class="tpl-card is-coming-soon" id="tpl-seed">
          <h3>üå± Seed Products</h3>
          <div class="tpl-actions">
            <a class="btn" href="#">View CSV</a>
            <a class="btn" href="#">Download CSV</a>
            <a class="btn" href="#">Download XLSX</a>
          </div>
          <div class="cols">Columns (planned): brand, product, crop, trait, maturity, notes</div>
          <div class="coming-pill"><span>Coming soon ‚Äî import not enabled yet</span></div>
        </article>

        <!-- COMING SOON: Chemical -->
        <article class="tpl-card is-coming-soon" id="tpl-chemical">
          <h3>üß™ Chemical Products</h3>
          <div class="tpl-actions">
            <a class="btn" href="#">View CSV</a>
            <a class="btn" href="#">Download CSV</a>
            <a class="btn" href="#">Download XLSX</a>
          </div>
          <div class="cols">Columns (planned): brand, product, activeIngredient, rateUnit, epaNumber</div>
          <div class="coming-pill"><span>Coming soon ‚Äî import not enabled yet</span></div>
        </article>

        <!-- COMING SOON: Fertilizer -->
        <article class="tpl-card is-coming-soon" id="tpl-fertilizer">
          <h3>üßÇ Fertilizer Products</h3>
          <div class="tpl-actions">
            <a class="btn" href="#">View CSV</a>
            <a class="btn" href="#">Download CSV</a>
            <a class="btn" href="#">Download XLSX</a>
          </div>
          <div class="cols">Columns (planned): product, grade(N-P-K), form, notes</div>
          <div class="coming-pill"><span>Coming soon ‚Äî import not enabled yet</span></div>
        </article>

        <!-- COMING SOON: Employees -->
        <article class="tpl-card is-coming-soon" id="tpl-employees">
          <h3>üë§ Employees</h3>
          <div class="tpl-actions">
            <a class="btn" href="#">View CSV</a>
            <a class="btn" href="#">Download CSV</a>
            <a class="btn" href="#">Download XLSX</a>
          </div>
          <div class="cols">Columns (planned): firstName, lastName, email, phone, permissionGroup</div>
          <div class="coming-pill"><span>Coming soon ‚Äî import not enabled yet</span></div>
        </article>

        <!-- COMING SOON: Vendors -->
        <article class="tpl-card is-coming-soon" id="tpl-vendors">
          <h3>üè™ Vendors</h3>
          <div class="tpl-actions">
            <a class="btn" href="#">View CSV</a>
            <a class="btn" href="#">Download CSV</a>
            <a class="btn" href="#">Download XLSX</a>
          </div>
          <div class="cols">Columns (planned): name, contact, email, phone, address, city, state, zip</div>
          <div class="coming-pill"><span>Coming soon ‚Äî import not enabled yet</span></div>
        </article>

        <!-- COMING SOON: Sub-Contractors -->
        <article class="tpl-card is-coming-soon" id="tpl-subs">
          <h3>üß∞ Sub-Contractors</h3>
          <div class="tpl-actions">
            <a class="btn" href="#">View CSV</a>
            <a class="btn" href="#">Download CSV</a>
            <a class="btn" href="#">Download XLSX</a>
          </div>
          <div class="cols">Columns (planned): company, contact, email, phone, services</div>
          <div class="coming-pill"><span>Coming soon ‚Äî import not enabled yet</span></div>
        </article>

        <!-- COMING SOON: Vehicle Registration -->
        <article class="tpl-card is-coming-soon" id="tpl-veh-reg">
          <h3>üöó Vehicle Registration</h3>
          <div class="tpl-actions">
            <a class="btn" href="#">View CSV</a>
            <a class="btn" href="#">Download CSV</a>
            <a class="btn" href="#">Download XLSX</a>
          </div>
          <div class="cols">Columns (planned): plate, vin, make, model, year, expires, notes</div>
          <div class="coming-pill"><span>Coming soon ‚Äî import not enabled yet</span></div>
        </article>

        <!-- COMING SOON: RTK Towers -->
        <article class="tpl-card is-coming-soon" id="tpl-rtk">
          <h3>üõ∞Ô∏è RTK Towers</h3>
          <div class="tpl-actions">
            <a class="btn" href="#">View CSV</a>
            <a class="btn" href="#">Download CSV</a>
            <a class="btn" href="#">Download XLSX</a>
          </div>
          <div class="cols">Columns (planned): towerName, frequency, location, status, notes</div>
          <div class="coming-pill"><span>Coming soon ‚Äî import not enabled yet</span></div>
        </article>

        <!-- COMING SOON: Equipment ‚Äî Tractors -->
        <article class="tpl-card is-coming-soon" id="tpl-eq-tractors">
          <h3>üöú Equipment ‚Äî Tractors</h3>
          <div class="tpl-actions">
            <a class="btn" href="#">View CSV</a>
            <a class="btn" href="#">Download CSV</a>
            <a class="btn" href="#">Download XLSX</a>
          </div>
          <div class="cols">Columns (planned): unitId, make, model, year, hours, notes</div>
          <div class="coming-pill"><span>Coming soon ‚Äî import not enabled yet</span></div>
        </article>

        <!-- COMING SOON: Equipment ‚Äî Sprayers -->
        <article class="tpl-card is-coming-soon" id="tpl-eq-sprayers">
          <h3>üí¶ Equipment ‚Äî Sprayers</h3>
          <div class="tpl-actions">
            <a class="btn" href="#">View CSV</a>
            <a class="btn" href="#">Download CSV</a>
            <a class="btn" href="#">Download XLSX</a>
          </div>
          <div class="cols">Columns (planned): unitId, make, model, boomWidthFt, tankGal, notes</div>
          <div class="coming-pill"><span>Coming soon ‚Äî import not enabled yet</span></div>
        </article>

        <!-- COMING SOON: Equipment ‚Äî Combines -->
        <article class="tpl-card is-coming-soon" id="tpl-eq-combines">
          <h3>üåæ Equipment ‚Äî Combines</h3>
          <div class="tpl-actions">
            <a class="btn" href="#">View CSV</a>
            <a class="btn" href="#">Download CSV</a>
            <a class="btn" href="#">Download XLSX</a>
          </div>
          <div class="cols">Columns (planned): unitId, make, model, year, engineHours, separatorHours</div>
          <div class="coming-pill"><span>Coming soon ‚Äî import not enabled yet</span></div>
        </article>

        <!-- COMING SOON: Equipment ‚Äî Implements -->
        <article class="tpl-card is-coming-soon" id="tpl-eq-implements">
          <h3>‚öôÔ∏è Equipment ‚Äî Implements</h3>
          <div class="tpl-actions">
            <a class="btn" href="#">View CSV</a>
            <a class="btn" href="#">Download CSV</a>
            <a class="btn" href="#">Download XLSX</a>
          </div>
          <div class="cols">Columns (planned): unitId, type, make, model, widthFt, notes</div>
          <div class="coming-pill"><span>Coming soon ‚Äî import not enabled yet</span></div>
        </article>

        <!-- COMING SOON: Equipment ‚Äî Trucks -->
        <article class="tpl-card is-coming-soon" id="tpl-eq-trucks">
          <h3>üöö Equipment ‚Äî Trucks</h3>
          <div class="tpl-actions">
            <a class="btn" href="#">View CSV</a>
            <a class="btn" href="#">Download CSV</a>
            <a class="btn" href="#">Download XLSX</a>
          </div>
          <div class="cols">Columns (planned): unitId, vin, plate, make, model, year, notes</div>
          <div class="coming-pill"><span>Coming soon ‚Äî import not enabled yet</span></div>
        </article>

        <!-- COMING SOON: Equipment ‚Äî Trailers -->
        <article class="tpl-card is-coming-soon" id="tpl-eq-trailers">
          <h3>üöõ Equipment ‚Äî Trailers</h3>
          <div class="tpl-actions">
            <a class="btn" href="#">View CSV</a>
            <a class="btn" href="#">Download CSV</a>
            <a class="btn" href="#">Download XLSX</a>
          </div>
          <div class="cols">Columns (planned): unitId, vin, type, lengthFt, notes</div>
          <div class="coming-pill"><span>Coming soon ‚Äî import not enabled yet</span></div>
        </article>

      </section>
    </div>
  </fv-shell>

  <!-- Modal for Fields CSV preview -->
  <div id="csvModal" class="modal" aria-hidden="true">
    <div class="dialog" role="dialog" aria-modal="true" aria-labelledby="csvModalTitle" data-perm="setup-import-templates:view">
      <div class="dialog-head">
        <h3 id="csvModalTitle">Fields Import ‚Äî CSV Preview</h3>
        <button id="csvModalClose" class="closex" type="button">Close</button>
      </div>
      <div class="dialog-body">
        <div class="csv-note">
          This is the exact header row and a sample line used by the Fields import.
          You can copy/paste into Excel or use the download buttons on the card.
        </div>
        <pre class="csv-preview" aria-label="Fields CSV template preview">
farmCode,name,state,county,tillableAcres,helAcres,crpAcres,rtkTowerCode,status
DF-0502,North 80,IL,Pike,80,0,0,RTK-01,active
        </pre>
      </div>
      <div class="dialog-footer">
        <button id="csvModalCloseBottom" class="closex" type="button">Close</button>
      </div>
    </div>
  </div>

  <script>
    (function(){
      "use strict";
      const modal = document.getElementById("csvModal");
      const openBtn = document.getElementById("btnFieldsViewCsv");
      const closeTop = document.getElementById("csvModalClose");
      const closeBottom = document.getElementById("csvModalCloseBottom");

      const canNow = (k)=> (window.FV && typeof window.FV.can === 'function') ? window.FV.can(k) : true;

      if(openBtn && modal){
        const openModal = () => {
          modal.setAttribute("open", "");
          modal.setAttribute("aria-hidden", "false");
          document.documentElement.classList.add("no-scroll");
          document.body.classList.add("no-scroll");
        };
        const closeModal = () => {
          modal.removeAttribute("open");
          modal.setAttribute("aria-hidden", "true");
          document.documentElement.classList.remove("no-scroll");
          document.body.classList.remove("no-scroll");
        };

        openBtn.addEventListener("click", (e) => {
          e.preventDefault();
          if(!canNow('setup-import-templates:view')){
            alert("You don't have permission to view import templates.");
            return;
          }
          openModal();
        });
        closeTop.addEventListener("click", closeModal);
        closeBottom.addEventListener("click", closeModal);

        modal.addEventListener("click", (e) => {
          if(e.target === modal){ closeModal(); }
        });
        document.addEventListener("keydown", (e) => {
          if(e.key === "Escape" && modal.hasAttribute("open")){ closeModal(); }
        });
      }
    })();
  </script>
</body>
</html>
