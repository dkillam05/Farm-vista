<!doctype html><html lang="en"><head>
  <meta charset="utf-8"/>
  <title>FarmVista • Setup → Products → Chemical</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <meta name="theme-color" content="#3B7E46"/>

  <link rel="manifest" href="/Farm-vista/manifest.webmanifest"/>
  <link rel="apple-touch-icon" href="/Farm-vista/assets/icons/apple-touch-icon.png"/>
  <link rel="icon" href="/Farm-vista/assets/icons/icon-192.png"/>
  <script src="/Farm-vista/js/theme-boot.js"></script>
  <link rel="stylesheet" href="/Farm-vista/assets/css/theme.css"/>
  <link rel="stylesheet" href="/Farm-vista/assets/css/app.css"/>

  <style>
    .section{border:1px solid var(--border); border-radius:14px; background:var(--surface); box-shadow:var(--shadow,0 8px 20px rgba(0,0,0,.08));}
    .section-head{display:grid; grid-template-columns:36px 1fr; gap:12px; align-items:center; padding:14px 16px; border-bottom:1px solid var(--border); background:linear-gradient(90deg, rgba(47,108,60,.12), transparent);}
    .section-head .icon{width:24px; height:24px; color:#2F6C3C; display:grid; place-items:center;}
    .section-body{padding:16px; display:grid; gap:14px;}
    .grid-2{display:grid; gap:10px; grid-template-columns:1fr 1fr;}
    .grid-3{display:grid; gap:10px; grid-template-columns:1fr 1fr 1fr;}
    @media(max-width:880px){ .grid-2, .grid-3 { grid-template-columns:1fr; } }
    .field label{display:block; font-weight:800; margin:0 0 6px 0;}
    .input,.select,.textarea{width:100%; font:inherit; font-size:16px; color:var(--text); background:var(--card-surface,var(--surface)); border:1px solid var(--border); border-radius:10px; padding:12px; outline:none;}
    .textarea{min-height:96px; resize:vertical;}
    .help{font-size:13px; color:var(--muted,#67706B);}
    .actions{display:flex; gap:12px; flex-wrap:wrap}
    .btn{display:inline-flex; align-items:center; justify-content:center; min-width:148px; padding:12px 16px; border-radius:12px; border:1px solid var(--border); background:var(--card-surface,var(--surface)); font-weight:800; color:var(--text); cursor:pointer;}
    .btn-primary{border-color:transparent; background:#2F6C3C; color:#fff;}
    .toast{position:fixed; left:50%; bottom:calc(env(safe-area-inset-bottom,0px) + 72px); transform:translateX(-50%); background:#2F6C3C; color:#fff; padding:10px 14px; border-radius:10px; box-shadow:0 6px 20px rgba(0,0,0,.25); z-index:99999; display:none;}
    .toast.show{display:block; animation:fadeout 2.8s forwards;}
    @keyframes fadeout{0%{opacity:1} 85%{opacity:1} 100%{opacity:0}}
    .page{max-width:1100px; margin:0 auto; padding:clamp(14px,3vw,22px); padding-bottom:calc(env(safe-area-inset-bottom,0px) + var(--ftr-h,42px) + 96px)!important;}
    .page-title{margin:0 0 8px 0;}
    .page-sub{margin:0 0 14px 0; color:var(--muted,#67706B);}
  </style>

  <script>(function(){ if(!customElements.get('fv-shell')){ const s=document.createElement('script'); s.src='/Farm-vista/js/fv-shell.js'; s.defer=true; document.head.appendChild(s);} })();</script>
</head><body>
  <fv-shell>
    <div class="page container">
      <h1 class="page-title">Chemical Setup</h1>
      <p class="page-sub">Add crop-protection products (herbicides, fungicides, insecticides, adjuvants). Track crop fit, formulation, density, and labeled rates for reports & mixes.</p>

      <section class="section">
        <header class="section-head">
          <div class="icon" aria-hidden="true">
            <!-- beaker icon (MIT Tabler) -->
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
                 stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M10 6l1 0l0 7a4 4 0 1 1 -2 0l0 -7z" />
              <path d="M7 6l10 0" />
            </svg>
          </div>
          <div>
            <strong>New Chemical Product</strong>
            <div class="help">Crop fit (corn/soy/both) + company + formulation and rate details.</div>
          </div>
        </header>

        <div class="section-body">
          <div class="grid-3">
            <div class="field">
              <label for="company">Company</label>
              <select id="company" class="select">
                <option value="">—</option>
                <option>Bayer</option>
                <option>Syngenta</option>
                <option>Corteva</option>
                <option>BASF</option>
                <option>FMC</option>
                <option>ADAMA</option>
                <option>UPL</option>
                <option>Nufarm</option>
                <option>Other</option>
              </select>
              <div class="help">Top global suppliers; choose “Other” if needed.</div>
            </div>
            <div class="field">
              <label for="product">Product Name</label>
              <input id="product" class="input" placeholder="e.g., Harness, Enlist One, Liberty, Zidua">
            </div>
            <div class="field">
              <label for="category">Product Category</label>
              <select id="category" class="select">
                <option value="herbicide">Herbicide</option>
                <option value="fungicide">Fungicide</option>
                <option value="insecticide">Insecticide</option>
                <option value="adjuvant">Adjuvant</option>
              </select>
            </div>
          </div>

          <div class="grid-3">
            <div class="field">
              <label for="cropfit">Crop Fit</label>
              <select id="cropfit" class="select">
                <option value="">—</option>
                <option value="corn">Corn</option>
                <option value="soybean">Soybean</option>
                <option value="both">Both</option>
              </select>
            </div>
            <div class="field">
              <label for="ai">Active Ingredient(s)</label>
              <input id="ai" class="input" placeholder="e.g., acetochlor + atrazine">
            </div>
            <div class="field">
              <label for="moa">MOA Group(s)</label>
              <input id="moa" class="input" placeholder="WSSA/HRAC numbers, e.g., 4 + 9 + 15">
              <div class="help">Use WSSA/HRAC group numbers (e.g., 4=Auxin, 9=EPSPS, 10=GS, 14=PPO, 15=VLCFA, 27=HPPD).</div>
            </div>
          </div>

          <div class="grid-3">
            <div class="field">
              <label for="form">Formulation</label>
              <select id="form" class="select">
                <option value="">—</option>
                <option>EC (Emulsifiable Concentrate)</option>
                <option>SC (Suspension/Flowable)</option>
                <option>SL (Soluble Liquid)</option>
                <option>WG / WDG (Water-dispersible granule)</option>
                <option>WP (Wettable Powder)</option>
                <option>CS (Capsule Suspension)</option>
                <option>SE (Suspo-emulsion)</option>
                <option>OD / ME (Oil Dispersion/Micro-encaps.)</option>
              </select>
            </div>
            <div class="field">
              <label for="density">Product Density</label>
              <div class="grid-2">
                <input id="density" class="input" inputmode="decimal" placeholder="e.g., 10.3">
                <select id="densityUnit" class="select">
                  <option>lb/gal</option>
                  <option>g/mL</option>
                </select>
              </div>
              <div class="help">Helps convert gal↔lb in mix sheets.</div>
            </div>
            <div class="field">
              <label for="carrier">Carrier Volume (optional)</label>
              <div class="grid-2">
                <input id="carrier" class="input" inputmode="decimal" placeholder="e.g., 15">
                <select id="carrierUnit" class="select">
                  <option>gal/ac</option>
                  <option>L/ha</option>
                </select>
              </div>
            </div>
          </div>

          <div class="grid-3">
            <div class="field">
              <label for="rate">Labeled Rate</label>
              <div class="grid-2">
                <input id="rate" class="input" inputmode="decimal" placeholder="e.g., 2">
                <select id="rateUnit" class="select">
                  <option>oz/ac</option><option>pt/ac</option><option>qt/ac</option><option>gal/ac</option><option>lb/ac</option>
                </select>
              </div>
              <div class="help">Use typical single-pass rate; you can note min/max in Notes.</div>
            </div>
            <div class="field">
              <label for="rei">REI / PHI</label>
              <div class="grid-2">
                <input id="rei" class="input" inputmode="numeric" placeholder="REI hrs">
                <input id="phi" class="input" inputmode="numeric" placeholder="PHI days">
              </div>
            </div>
            <div class="field">
              <label for="rup">Restricted Use?</label>
              <select id="rup" class="select">
                <option value="">—</option>
                <option value="no">No</option>
                <option value="yes">Yes</option>
              </select>
            </div>
          </div>

          <div class="field">
            <label for="notes">Notes</label>
            <textarea id="notes" class="textarea" placeholder="Premix partners, residual, surfactant needs, tank-mix cautions, etc."></textarea>
          </div>

          <div class="actions">
            <button id="clear" class="btn" type="button">Clear</button>
            <button id="save" class="btn btn-primary" type="button">Save Chemical</button>
          </div>
        </div>
      </section>
    </div>
  </fv-shell>

  <div id="toast" class="toast" role="status" aria-live="polite">Saved.</div>

  <script>
  (function(){
    "use strict";
    const $=id=>document.getElementById(id);
    const STORAGE_KEY="fv_chem_products_v1";
    const toast=$("toast");

    function showToast(msg="Saved."){ toast.textContent=msg; toast.classList.remove("show"); void toast.offsetWidth; toast.classList.add("show"); }
    function loadAll(){ try{ const a=JSON.parse(localStorage.getItem(STORAGE_KEY)||"[]"); return Array.isArray(a)?a:[]; }catch(e){ return []; } }
    function saveAll(a){ localStorage.setItem(STORAGE_KEY, JSON.stringify(a)); }

    function validate(){
      if(!$("product").value.trim()) return "Enter a product name.";
      if(!$("category").value) return "Choose a product category.";
      if(!$("cropfit").value) return "Select crop fit (Corn/Soybean/Both).";
      return "";
    }

    $("save").addEventListener("click", ()=>{
      const err=validate(); if(err){ alert(err); return; }
      const item={
        t: Date.now(),
        company: $("company").value,
        product: $("product").value.trim(),
        category: $("category").value,
        cropfit: $("cropfit").value,
        ai: $("ai").value.trim(),
        moa: $("moa").value.trim(),
        form: $("form").value,
        density: $("density").value.trim(),
        densityUnit: $("densityUnit").value,
        carrier: $("carrier").value.trim(),
        carrierUnit: $("carrierUnit").value,
        rate: $("rate").value.trim(),
        rateUnit: $("rateUnit").value,
        rei: $("rei").value.trim(),
        phi: $("phi").value.trim(),
        rup: $("rup").value,
        notes: $("notes").value.trim()
      };
      const arr=loadAll(); arr.unshift(item); saveAll(arr); showToast("Chemical saved.");
    });

    $("clear").addEventListener("click", ()=>{
      ["company","product","category","cropfit","ai","moa","form","density","densityUnit","carrier","carrierUnit","rate","rateUnit","rei","phi","rup","notes"].forEach(id=>{
        const el=$(id); if(el.tagName==="SELECT") el.selectedIndex=0; else el.value="";
      });
    });
  })();
  </script>
</body></html>