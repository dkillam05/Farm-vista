/* ==========================================================
   File: /assets/css/app.css
   Purpose: Page-level layout glue that sits on top of theme.css.
   - Prevents horizontal scroll
   - Safe-area aware side paddings
   - Flex shell so the footer sits flush at the bottom
   - Guardrails for accidental 100vw usage
   - Global rounded form controls (inputs/selects) ✅
   ========================================================== */

/* ---------- Safe-area variables ---------- */
:root{
  --safe-left:  env(safe-area-inset-left);
  --safe-right: env(safe-area-inset-right);
  --safe-bottom:env(safe-area-inset-bottom);
}

/* ---------- Global guards ---------- */
html, body { overflow-x: hidden; }

/* ---------- Flex shell so footer stays at bottom ---------- */
#app, .app-shell{
  min-height: 100vh;
  min-height: 100svh;
  display: flex;
  flex-direction: column;
}

/* ---------- Default paddings (safe-area aware) ---------- */
.app-header,
.breadcrumbs-bar,
.app-main,
.app-footer{
  padding-left:  max(16px, var(--safe-left));
  padding-right: max(16px, var(--safe-right));
}

/* Main grows; footer sits at bottom */
.app-main{ flex: 1 1 auto; }

/* Footer gets extra bottom padding for iOS home-indicator */
.app-footer{
  margin-top: auto;
  padding-bottom: calc(12px + var(--safe-bottom));
}

/* ---------- Content helpers ---------- */
.container{ max-width: 1100px; margin: 0 auto; padding: 16px; }
.cards{ display: grid; gap: 12px; }
.card  {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 14px;
  box-shadow: var(--shadow);
}

/* ---------- 100vw guardrail ---------- */
[class*="vw"], [style*="100vw"]{
  width: 100% !important;
  max-width: 100% !important;
}

/* ---------- Optional: lock scroll when overlays are open ---------- */
body.drawer-open{ overflow: hidden; }

/* ==========================================================
   FarmVista — Global form controls (one-and-done)
   ========================================================== */

:root{
  --fv-field-h:       44px;
  --fv-field-pad-x:   12px;
  --fv-field-radius:  10px; /* matches your combo template */
  --fv-field-font:    500 16px/1.25 system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
  --fv-field-bg:      var(--card-surface, var(--surface));
  --fv-field-fg:      var(--text);
  --fv-field-border:  1px solid var(--border);
  --fv-caret:         url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="14" height="8" viewBox="0 0 14 8"><path d="M1 1l6 6 6-6" fill="none" stroke="%2367706B" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>');
}

/* Reusable inputs (text/number/search/password/etc.) */
.fv-input,
fv-shell input:not([type="checkbox"]):not([type="radio"]){
  display:block;
  width:100%;
  box-sizing:border-box;
  height:var(--fv-field-h);
  padding:0 var(--fv-field-pad-x);
  border:var(--fv-field-border);
  border-radius:var(--fv-field-radius);
  background:var(--fv-field-bg);
  color:var(--fv-field-fg);
  font:var(--fv-field-font);
  line-height:var(--fv-field-h);           /* vertical centering */
  -webkit-appearance:none;
  appearance:none;
  background-clip:padding-box;
}

/* Textarea */
.fv-textarea,
fv-shell textarea{
  display:block;
  width:100%;
  box-sizing:border-box;
  min-height:120px;
  padding:10px var(--fv-field-pad-x);
  border:var(--fv-field-border);
  border-radius:var(--fv-field-radius);
  background:var(--fv-field-bg);
  color:var(--fv-field-fg);
  font:var(--fv-field-font);
  resize:vertical;
  background-clip:padding-box;
}

/* Native date/time pickers get same baseline */
input[type="date"],
input[type="datetime-local"],
input[type="time"]{
  display:block;
  width:100%;
  box-sizing:border-box;
  height:var(--fv-field-h);
  padding:0 var(--fv-field-pad-x);
  border:var(--fv-field-border);
  border-radius:var(--fv-field-radius);
  background:var(--fv-field-bg);
  color:var(--fv-field-fg);
  font:var(--fv-field-font);
  line-height:var(--fv-field-h);
  -webkit-appearance:none;
  appearance:none;
  background-clip:padding-box;
}

/* Normalize editable area on WebKit so text sits centered */
input[type="date"]::-webkit-datetime-edit,
input[type="datetime-local"]::-webkit-datetime-edit,
input[type="time"]::-webkit-datetime-edit{
  padding:0;
}

/* Calendar / clock icon */
input[type="date"]::-webkit-calendar-picker-indicator,
input[type="datetime-local"]::-webkit-calendar-picker-indicator,
input[type="time"]::-webkit-calendar-picker-indicator{
  opacity:.9;
  cursor:pointer;
  margin-right:6px;
}

/* Remove spin buttons */
input[type="time"]::-webkit-inner-spin-button,
input[type="date"]::-webkit-inner-spin-button,
input[type="datetime-local"]::-webkit-inner-spin-button{
  display:none;
}

/* ---------- SELECTS (GLOBAL) ---------- */
/* Applies to every page automatically */
.fv-select,
fv-shell select{
  display:block;
  width:100%;
  box-sizing:border-box;
  height:var(--fv-field-h);
  padding:0 var(--fv-field-pad-x);
  border:var(--fv-field-border);
  border-radius:var(--fv-field-radius);
  background:var(--fv-field-bg);
  color:var(--fv-field-fg);
  font:var(--fv-field-font);
  line-height:var(--fv-field-h);
  -webkit-appearance:none;
  -moz-appearance:none;
  appearance:none;
  background-clip:padding-box;
  /* custom caret */
  background-image: var(--fv-caret);
  background-repeat:no-repeat;
  background-position:right 12px center;
  background-size:14px 8px;
  padding-right: calc(var(--fv-field-pad-x) + 28px); /* room for caret */
}
fv-shell select::-ms-expand{ display:none; } /* legacy IE */

/* Opt-out: remove caret if needed (e.g., custom combos) */
.no-caret{ background-image:none !important; }

/* Hover/Focus (brand-friendly, no blue) */
.fv-input:hover,
.fv-textarea:hover,
.fv-select:hover,
fv-shell select:hover,
input[type="date"]:hover,
input[type="datetime-local"]:hover,
input[type="time"]:hover{
  border-color: color-mix(in srgb, var(--border), #000 20%);
}
.fv-input:focus,
.fv-textarea:focus,
.fv-select:focus,
fv-shell select:focus,
input[type="date"]:focus,
input[type="datetime-local"]:focus,
input[type="time"]:focus{
  outline: none;
  border-color: color-mix(in srgb, var(--accent, #2F6C3C), #000 15%);
  box-shadow: 0 0 0 2px color-mix(in srgb, var(--accent, #2F6C3C), transparent 70%);
}

/* Invalid helper (shared) */
.is-invalid{ border-color:#b00020 !important; }
.is-invalid + .help{ color:#b00020; }

/* Dark theme bridge */
:root.dark .fv-input,
:root.dark .fv-textarea,
:root.dark .fv-select,
:root.dark fv-shell select,
:root.dark input[type="date"],
:root.dark input[type="datetime-local"],
:root.dark input[type="time"]{
  --fv-field-bg:     var(--surface);
  --fv-field-fg:     var(--text);
  --fv-field-border: 1px solid var(--border);
}

/* Opt-out any container if you ever want square fields */
.fv-no-round .fv-input,
.fv-no-round .fv-textarea,
.fv-no-round .fv-select,
.fv-no-round select{
  border-radius:4px !important;
  background-image:none !important;
}

/* ==========================================================
   FarmVista — Global page header pattern (shared title + summary)
   ========================================================== */
.page{ padding-block:10px 24px; }
.page-title{
  margin:12px 0 4px;
  line-height:1.15;
  color:var(--text);
}
.page-sub{
  margin:0 0 16px;
  color:var(--muted, #8a928c);
}

/* Optional small variant for sub-sections (avoids inline styles) */
.page-title-sm{
  font-size:18px;
  line-height:1.2;
  margin:0 0 10px;
  color:var(--text);
}

/* ==========================================================
   FarmVista — Fix link color inheritance (dark + light)
   ========================================================== */
.section a,
.card a,
.tile a,
.panel a,
.section a:link,
.card a:link,
.tile a:link,
.panel a:link,
.section a:visited,
.card a:visited,
.tile a:visited,
.panel a:visited {
  color: inherit !important;
  text-decoration: none;
}
.section a .label,
.card a .label,
.tile a .label,
.panel a .label {
  color: inherit !important;
}
